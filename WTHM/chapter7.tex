% This work is licensed under the Creative Commons
% Attribution-NonCommercial-ShareAlike 4.0 International License. To view a copy
% of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/ or
% send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.

\chapter{Inversion der Fouriertransformation und Eindeutigkeitssatz} %7

Zentrale Frage: Eindeutigkeit der Fouriertransformation / Charakteristischen Funktion
\begin{align*}
	\hat{f}=\hat{g} \overset{?}&\implies f= g\\
	\Phi_X=\Phi_Y \overset{?}&\implies X\sim Y
\end{align*}

Wichtig z.B. in Theorem \ref{theorem6.5CharakterisierungDerUnabhaengigkeit}.

\section{Inversion der Fouriertransformation}
\begin{defi}
	Für $f:\R^d\to\C$ ist der  \textbf{Träger (Support)} definiert als
	\begin{align*}
		\supp(f):=\overline{\Big\lbrace x\in\R^d:f(x)\neq0\Big\rbrace}\subseteq\R^d
	\end{align*}
	Hierbei ist der Abschluss in $\R^d$ gemeint.
\end{defi}

Es gilt:
\begin{align*}
	x\not\in\supp(f)&\implies f(x)=0\\
	x\in\supp(f)&\implies\text{ Jede Umgebung von $x$ enthält $y$ mit $f(y)\neq0$}
\end{align*}

\begin{defi}\
	\begin{enumerate}[label=(\alph*)]
		\item Der (Vektor-)Raum der \textbf{Testfunktionen} ist gegeben durch
		\begin{align*}
			C_c^\infty(\R^d):=\Big\lbrace f:\R^d\to\C:\supp(f)\text{ beschränkt und $f$ beliebig ist stetig diffbar}\Big\rbrace
		\end{align*}
		Der Subindex $c$ steht hierbei für "compact Support".
		\item Der (Vektor-)Raum der \textbf{Schwartz-Funktionen (rapidly decreasing functions)} ist definiert durch
		\begin{align*}
			S(\R^d)&:=\Big\lbrace f:\R^d\to\C: f\text{ beliebig oft diffbar und }C_{n,\alpha}(f)<\infty~\forall n\in\N,\alpha\in\N_0\Big\rbrace
		\end{align*}
		mit
		\begin{align*}
			C_{n,\alpha}(f)&:=\sup\limits_{x\in\R^d}\left|\left(1+|x|^2\right)^N\cdot\partial^\alpha f(x)\right|\qquad\forall N\in\N,\forall\alpha\in\N_0^\alpha
		\end{align*}
		Das heißt
		\begin{align*}
			f\in S(\R^d) &\implies\left|\partial^\alpha f(x)\right|\leq C_{n,\alpha}(f)\cdot\big(1+|x|^2\big)^{-N}\qquad\forall x\in\R^d
		\end{align*}
		"Alle Ableitungen fallen schneller als polynomiell."
	\end{enumerate}
\end{defi}

\begin{beisp}\
	\begin{enumerate}
		\item Beispiel einer Testfunktion:
		\begin{align*}
			f(x)=\left\lbrace\begin{array}{cl}
				\exp\left(\frac{b^2}{x^2-b^2}\right), &\falls x\in[-b,b],~b>0\\
				0, &\sonst
			\end{array}\right.\qquad\forall x\in\R
		\end{align*}
		\item Beispiel einer Schwartz-Funktion:
		\begin{align*}
			f(x)=\exp\left(-\frac{x^2}{2}\right)\qquad\forall x\in\R
		\end{align*}
	\end{enumerate}
\end{beisp}

\begin{bemerkung}
	$C_c^\infty$ und $S(\R^d)$ können mit Topologie versehen werden $\implies$ lokal-konvexe topologische Vektorräume, aber \underline{keine Banachräume}.
\end{bemerkung}

\begin{proposition}\label{proposition7.1}\
	\begin{enumerate}[label=(\alph*)]
		\item Es gilt
		\begin{align*}
			C_c^\infty(\R^d)\subseteq S(\R^d)\subseteq L_p(\R^d)\qquad\forall p\in[1,\infty]
		\end{align*}
		und
		\begin{align*}
			S(\R^d)\text{ ist dicht in }L_p(\R^d)\qquad\forall p\in[1,\infty)
		\end{align*}
		\item $\forall K\subseteq\R^d$ kompakt $\exists$ Folge $(u_n)_{n\in\N}\subseteq C_c^\infty(\R^d)$ so, dass
		$0\leq u_n\leq 1~\forall n\in\N$ und $u_n\downarrow\indi_K$ für $n\to\infty$
	\end{enumerate}
\end{proposition}

\begin{proof}
	Vielleicht als Übungsaufgabe.
\end{proof}

\begin{theorem}\label{theorem7.2}
	Die Fourier-Transformation bildet $S(\R^d)$ nach $S(\R^d)$ ab.
\end{theorem}

\begin{proof}
	Sei $f\in S(\R^d)$. Dann ist $f\in L_1(\R^d)$. Nach
	Theorem \ref{theorem6.1EigenschaftenDerFTCF}
	existiert die FT $\hat{f}$. Wähle Multiindizes $\alpha,\beta\in\N_0^d$ und setze
	\begin{align*}
		g_{\alpha,\beta}(x):=\partial_x^\beta\left((i\cdot x)^\alpha\cdot f(x)\right)
	\end{align*}
	Leibniz-Formel:
	\begin{align*}
		g_{\alpha,\beta}(x)
		&:=\sum\limits_{\begin{subarray}{c}\gamma\leq\beta\\\gamma\in\N_0^d\end{subarray}}\underbrace{\begin{pmatrix}
		\beta\\\gamma
		\end{pmatrix}\cdot\partial_x^\gamma(i\cdot x)^\alpha}_{\text{Polynom in $x$, Grad}\leq|\alpha|}\cdot\partial_x^{\beta-\gamma}f(x)
	\end{align*}
	Folglich gilt:
	\begin{align*}
		f\in S(\R^d)&\implies\partial^{\beta-\gamma} f\in S(\R^d) \\
		&\implies g_{\alpha,\beta}\in S(\R^d)\\
		&\implies g_{\alpha,\beta}\in L_1(\R^d)
	\end{align*}
	Wir berechnen die Fouriertransformation von $g_{\alpha,\beta}$:
	\begin{align*}
		\hat{g}_{\alpha,\beta}(\xi)
		&=\F\left(\partial_x^\beta\Big((i\cdot x)^\alpha\cdot f(x)\Big)\right)(\xi)\\
		\overset{\ref{korollar6.3}}&=
		(-i\cdot \xi)^\beta\cdot\F\left((i\cdot x)^\alpha\cdot f(x)\right)(\xi)\\
		\overset{\ref{korollar6.3}}&=
		(-i\cdot\xi)^\beta\cdot\partial_\xi^\alpha\hat{f}(\xi)
	\end{align*}
	\begin{align*}
		&\implies&
		\left|\xi^\beta\cdot\partial_\xi^\alpha \hat{f}(\xi)\right| 
		&\leq\left|\hat{g}_{\alpha,\beta}(\xi)\right| \\
		&&&\leq\hat{g}_{\alpha,\beta}(0)\\
		&&&=\Vert g_{\alpha,\beta}\Vert_1<\infty \\
		&\implies&
		\sup\limits_{\xi\in\R^d}\big(1+|x|^2\big)^N\cdot\partial_\xi^\alpha\hat{f}(\xi)&<\infty\qquad\forall\alpha\in\N_0^d,\forall N\in\N \\
		&\implies&\hat{f}\in S(\R^d)
	\end{align*}
\end{proof}

\begin{korollar}[Riemann-Lebesgue-Lemma]\label{korollar7.3RiemanndLebesgue-Lemma}\enter
	Die Fouriertransformation bildet $L_1(\R^d)$ nach $C_\infty(\R^d)$ ab.
\end{korollar}

\begin{bemerkung}
	\begin{align*}
		C_\infty(\R^d):=\Big\lbrace f:\R^d\to\C: f\text{ stetig und }\lim\limits_{|x|\to\infty}f(x)=0\Big\rbrace
	\end{align*}
\end{bemerkung}

\begin{proof}
	Dass $\hat{f}$ stetig ist, folgt aus Theorem \ref{theorem6.1EigenschaftenDerFTCF}. Außerdem:
	\begin{align*}
		\big|\hat{f}(\xi)\big|
		&\leq\hat{f}(0)=\Vert f\Vert_1\implies\hat{f}\in C_b(\R^d)
	\end{align*}
	Beachte: $C_c\subseteq C_\infty\subseteq C_b\subseteq C$.
	Proposition \ref{proposition7.1} liefert:
	\begin{align*}
		S(\R^n)&\text{ dicht in }L_1(\R^d)\implies\exists(f_n)_{n\in\N}\subseteq S(\R^n):\Vert f-f_n\Vert_1\stackrel{n\to\infty}{\longrightarrow}0
	\end{align*}
	\begin{align*}
		\big|\hat{f}(\xi)\big|
		&\leq\big|\hat{f}(\xi)-\hat{f}_n(\xi)\big|+\big|\hat{f}_n(\xi)\big|\\
		&=\Bigg|\int\limits_{\R^d}\underbrace{\exp(i\cdot\xi^T\cdot x)}_{|\cdot|=1}\cdot\big(f(x)-f_n(x)\big)\d x\Bigg|+\big|\hat{f}_n(\xi)\big|\\
		&\leq
		\int\limits_{\R^d}\big|\exp(i\cdot\xi^T\cdot x)\big|\cdot\big|f(x)-f_n(x)\big|\d x+\big|\hat{f}_n(\xi)\big|\d x\\
		&=\underbrace{\big\Vert f-f_n\big\Vert_1}_{<\varepsilon\text{ für $n$ groß}}+\underbrace{\big|\hat{f}_n(\xi)\big|}_{\stackrel{\ref{theorem7.2}}{\in} S(\R^d)}
	\end{align*}
	\begin{align*}
		&\implies
		\lim\limits_{|\xi|\to\infty}\big|\hat{f}(\xi)\big|\leq\varepsilon+\underbrace{\lim\limits_{|\xi|\to\infty}\big|f_n(\xi)\big|}_{=0}=\varepsilon\mit			\varepsilon>0\\
		&\implies\lim\limits_{|\xi|\to\infty}\big|\hat{f}(\xi)\big|=0\\
		&\implies\hat{f}\in C_\infty(\R^d)
	\end{align*}
\end{proof}

\begin{theorem}[Inversion der Fouriertransformation]\label{theorem7.4InversionDerFourierTransformation}\enter
	Die Fouriertransformation $\F:S\big(\R^d\big)\to S\big(\R^d\big)$ ist eine Bijektion. Die Umkehrabbildung $\F^{-1}$ ist gegeben durch
	\begin{align}\label{eqTheorem7.4}\tag{IFT}
		\F^{-1}(g)(x)=\hut{g}(x):=\frac{1}{(2\cdot\pi)^d}\cdot\int\limits_{\R^d}\exp(-i\cdot x^T\cdot\xi)\cdot g(\xi)\d \xi,\qquad\forall x\in\R^d
	\end{align}
\end{theorem}

\begin{bemerkung}\
	\begin{itemize}
		\item Einziger Unterschied zwischen $\F$ und $\F^{-1}$ ist der Vorfaktor $\frac{1}{(2\cdot\pi)^d}$ und negatives Vorzeichen im Exponenten.
		\item Bei geeigneter Topologie auf $S(\R^d)$ ist $\F$ sogar Homeomorphismus (d.h. $\F$ und $\F^{-1}$ ist stetig).
	\end{itemize}
\end{bemerkung}

\begin{proof}
	Sei $f,g\in S(\R^d)$. Dann gilt:
	\begin{align}
		&\int\limits_{\R^d}\hat{f}(\xi)\cdot g(\xi)\cdot\exp(-i\cdot x^T\cdot\xi)\d\xi\nonumber\\
		\overset{\text{Def }\hat{f}}=&
		\int\limits_{\R^d}\int\limits_{\R^d}\exp(i\cdot y^T\cdot \xi)\cdot f(y)\d y\cdot g(\xi)\cdot\exp(-i\cdot x^T\cdot\xi)\d\xi\nonumber\\
		=&\int\limits_{\R^d}\int\limits_{\R^d}\exp\big(i\cdot\xi^T\cdot(y-x)\big)\cdot g(\xi)\d\xi\cdot f(y)\d y\nonumber\\
		=&\int\limits_{\R^d}\hat{g}(y-x)\cdot f(y)\d y\label{eqProof7.4SternStern}\tag{$\ast\ast$}
	\end{align}
	Wähle
	\begin{align*}
		g(x):=\frac{\varepsilon^d}{(2\cdot\pi)^{\frac{d}{2}}}\cdot\exp\left(-\frac{x^T\cdot x}{2}\cdot\varepsilon^2\right)
	\end{align*}
	was der Dichte der Normalverteilung $\mathcal{N}\left(0,\frac{1}{\varepsilon^2},\id_d\right)$ ist. Dann gilt:
	\begin{align*}
		\hat{g}(x)&=\exp\left(-\frac{x^T\cdot x}{2\cdot\varepsilon^2}\right)
	\end{align*}
	Ersetzen:
	\begin{align*}
		&\frac{\varepsilon^d}{(2\cdot\pi)^{\frac{d}{2}}}\cdot\int\limits_{\R^d}\underbrace{\hat{f}(\xi)}_{\in L_1}\cdot\underbrace{\exp\left(-\frac{\varepsilon^2}{2}\cdot\xi^T\cdot\xi-i\cdot x^T\cdot\xi\right)}_{|\cdot|\leq1}\d\xi\\
		&=\int\limits_{\R^d}\exp\left(-\frac{(y-x)^T\cdot(y-x)}{2\cdot\varepsilon^2}\right)\cdot f(y)\d y\\
		\overset{\text{Subs}}&=
		\varepsilon^d\cdot\int\limits_{\R^d}\underbrace{\exp\left(-\frac{z^T\cdot z}{2}\right)}_{\in L_1}\cdot\underbrace{f(x+z\cdot\varepsilon)}_{|\cdot|\leq\Vert f\Vert_\infty}\d z
	\end{align*}
	Bei der Substitution wird benutzt: $z:=\frac{y-x}{\varepsilon}$ und $\d z_i=\frac{\d y_i}{\varepsilon}$\nl
	Grenzwertbildung $\varepsilon\to0$ (+ dominierte Konvergenz) liefert:
	\begin{align*}
		\frac{1}{(2\cdot\pi)^{\frac{d}{2}}}\cdot\int\limits_{\R^d}\exp(-i\cdot x^T\cdot\xi)\cdot\hat{f}(\xi)\d\xi
		&=f(x)\cdot\underbrace{\int\limits_{\R^d}\exp\left(-\frac{z^T\cdot z}{2}\right)\d z}_{=(2\cdot\pi)^{\frac{d}{2}}}\\
		\implies
		\underbrace{\frac{1}{(2\cdot\pi)^{d}}\cdot\int\limits_{\R^d}\exp(-i\cdot x^T\cdot\xi)\cdot\hat{f}(\xi)\d\xi}_{=\F^{-1}(\hat{f}(x)}
		&=f(x)\qquad\forall x\in\R^d\\
		\implies\F^{-1}\circ\F=\id
	\end{align*}
	Analog zeigt man $\F\circ\F^{-1}=\id$.
\end{proof}

Setze $x:=0$ in \eqref{eqProof7.4SternStern}. Dann erhalten wir:
\begin{align*}
	\int\limits_{\R^d}\hat{f}(\xi)\cdot g(\xi)\d\xi=\int\limits_{\R^d} f(\xi)\cdot\hat{g}(\xi)\d\xi
\end{align*}
Mit Skalarprodukt $\langle f,g\rangle=\int\limits_{\R^d} f\cdot g$ in $L_2(\R^d)$ können wir das auch schreiben als
\begin{align*}
	\big\langle\F(f),g\big\rangle=\big\langle f,\F(g)\big\rangle
\end{align*}
D.h. $\F$ ist \textbf{selbstadjungiert} bzgl. $\langle\cdot,\cdot\rangle$ (Satz von Plaucharel).

\begin{korollar}[Satz von Plaucharel]\label{korollar7.5SatzvonPlaucharel}\enter
	Sei $f\in L_1(\R^d)$ und $\mu\in\M_b(\R^d)$. Dann gilt:
	\begin{align*}
		\int\limits_{\R^d}\hat{f}(\xi)~\mu(d\xi)=\int\limits_{\R^d}\hat{\mu}(\xi)\cdot f(\xi)\d\xi
	\end{align*}
\end{korollar}

\begin{proof}
	Integrale wohldefiniert?
	\begin{itemize}
		\item linke Seite: $\big|\hat{f}(\xi)\big|\leq\big|\hat{f}(0)\big|=\Vert f\Vert_1<\infty$, $\mu\in\M_b(\R^d)\implies$ Integral existiert
		\item rechte Seite: $\big|\hat{\mu}(\xi)\big|\leq\big|\hat{\mu}(0)\big|=\mu(\R^d)<\infty,~f\in L_1(\R^d)\implies$ Integral existiert
	\end{itemize}
	Also:
	\begin{align*}
		\int\limits_{\R^d}\hat{f}(\xi)~\mu(\d\xi)
		\overset{\text{Def }\hat{f}}&=
		\int\limits_{\R^d}\int\limits_{\R^d}\exp(-i\cdot x^T\cdot\xi)\cdot f(x)\d x~\mu(\d\xi)\\
		\overset{\text{Fubini}}&=
		\int\limits_{\R^d}\underbrace{\int\limits_{\R^d}\exp(i\cdot x^T\cdot\xi)~\mu(\d\xi)}_{=\hat{\mu}(x)}\cdot f(x)\d x\\
		&=\int\limits_{\R^d}\hat{\mu}(x)\cdot f(x)\d x
	\end{align*}
\end{proof}

\section{Eindeutigkeitssatz für Maße}
\begin{theorem}[Eindeutigkeitssatz]\label{theorem7.6Eindeutigkeitssatz}\enter
	Die Fouriertransformation $\F:\M_b(\R^d)\to C(\R^d)$ ist injektiv, d.h.
	\begin{align*}
		\Big(\forall\xi\in\R^d:\hat{\mu}(\xi)=\hat{\nu}(\xi)\Big)\implies\mu=\nu
		% in Stochastik würde ich nicht equiv verwenden, da Gleichheit nur Gleichheit bis auf Nullmengen ist und equiv (zumindest für für mich) soetwas wie überall Gleichheit bedeutet.
	\end{align*}
\end{theorem}

\begin{proof}
	Seien $\mu,\nu\in\M_b(\R^d)$ mit $\hat{\mu}(\xi)=\hat{\nu}(\xi)~\forall\xi\in\R^d$. Sei $f\in S(\R^d)$. Dann gilt:
	\begin{align*}
		\int\limits_{\R^d}\hat{f}(\xi)~\mu(\d\xi)
		\overset{\ref{korollar7.5SatzvonPlaucharel}}&=
		\int\limits_{\R^d} f(\xi)\cdot\hat{\mu}(\xi)\d\xi
		\overset{\hat{\mu}=\hat{\nu}}=
		\int\limits_{\R^d} f(\xi)\cdot\hat{\nu}(\xi)\d\xi
		\overset{\ref{korollar7.5SatzvonPlaucharel}}=
		\int\limits_{\R^d}\hat{f}(\xi)~\nu(\d\xi)
	\end{align*}
	Da $\F$ eine Bijektion von $S(\R^d)$ nach $S(\R^d)$ ist (wegen Theorem \ref{theorem7.4InversionDerFourierTransformation}),
	kann $\hat{f}$ jede beliebige Funktion in $S(\R^d)$ (und damit auch in $C_c^\infty(\R^d)$) darstellen.
	\begin{align*}
		\int\limits_{\R^d}\varphi(\xi)~\mu(\d\xi)&=\int\limits_{\R^d}\varphi(\xi)~\nu(\d\xi)\qquad\forall\varphi\in C_c^\infty(\R^d)
	\end{align*}
	Sei $K\subseteq\R^d$ kompakt.
	Mit Proposition \ref{proposition7.1} existiert eine Folge $(\varphi_n)_{n\in\N}\subseteq C_c^\infty$ mit $\varphi_n\downarrow\indi_K$ für $n\to\infty$.
	Mit monotoner Konvergenz folgt:
	\begin{align*}
		\mu(K)&=\limn\int\limits_{\R^d}\varphi_n(\xi)~\mu(\d\xi)
		=\limn\int\limits_{\R^d}\varphi_n(\xi)~\nu(\d\xi)
		=\nu(K)
	\end{align*}
	Kompakte Teilmengen von $\R^d$ bilden einen durchschnittsstabilen Erzeuger von $\B(\R^d)$ (Borel-Mengen). 
	Aus dem Eindeutigkeitssatz von Maßen aus der Maßtheorie folgt nun die Gleichheit der Maß: $\mu=\nu$.
\end{proof}

\begin{korollar}[Eindeutigkeitssatz auf $L_1$]\label{korollar7.7EindeutigkeitssatzAufL1}\enter
	Seien $f,g\in L_1(\R^d)$. Dann gilt:
	\begin{align*}
		\Big(\forall\xi\in\R^d:\hat{f}(\xi)=\hat{g}(\xi)\Big)\implies f\equiv g\text{ fast überall}
	\end{align*}
\end{korollar}

\begin{korollar}[Eindeutigkeitssatz für charakteristische Funktionen]\label{korollar7.8EindeutigkeitssatzFuerCharakteristischeFunktionen}\enter
	Seien $X,Y:\Omega\to\R^d$ Zufallsvariablen. Dann gilt:
	\begin{align*}
		\Big(\forall\xi\in\R^d:\Phi_X(\xi)=\Phi_X(\xi)\Big)\implies X\overset{\text{d}}{\sim} Y
	\end{align*}
	(d.h. $X$ und $Y$ haben dieselbe Verteilung.\\ Alternative Notationen: $X\sim Y$, $X\overset{\text{d}}{=}Y$)
\end{korollar}

Im Allgemeinen gibt es keine schöne Inversionsformel, aber:

\begin{theorem}[Levys Inversionsformel]\label{theorem7.9LevysInversionsformel}
	Sei $\mu\in\M_b(\R)$. Dann gilt für alle $a<b$:
	\begin{align*}
		\frac{1}{2}\cdot\mu\big(\lbrace a\rbrace\big)+\mu\big((a,b)\big)+\frac{1}{2}\cdot\mu\big(\lbrace b\rbrace\big)
	=\lim\limits_{T\to\infty}\frac{1}{2\cdot\pi}\cdot\int\limits_{-T}^T\frac{e^{-i\cdot a\cdot x}-e^{-i\cdot b\cdot x}}{i\cdot x}\cdot\tilde{\mu}(x)\d x
	\end{align*}
\end{theorem}

\section{Zusammenfassung}
Die Fourier-Transformation $\ldots$
\begin{itemize}
	\item ist Bijektion von $S(\R^d)$ nach $S(\R^d)$ (Inversionsformel: \eqref{eqTheorem7.4})
	\item ist Injektion von $\M_b(\R^d)$ nach $C(\R^d)$
	\item bildet $L_1(\R^d)$ nach $C_\infty(\R^d)$ ab (Riemann-Lebesgue-Lemma \ref{korollar7.3RiemanndLebesgue-Lemma})
	\item ist selbstadjungiert bezgl. $\langle f,g\rangle=\int\limits_{\R^d}f\cdot g$, siehe auch Satz von Plaucharel \ref{korollar7.5SatzvonPlaucharel}
\end{itemize}
Die charakteristische Funktion $\Phi_X$ charakterisiert die Vorteilung von $X$ eindeutig.
