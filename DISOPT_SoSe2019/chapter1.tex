\section{Lineare Optimierung}
ganzzahlige Lineare Programme:
\begin{equation*}
	\min_{x} c^Tx \text{ subject to } \quad Ax = b, x \geq 0, x \in \Z^n
\end{equation*}
\subsection{Optimaltiätsbedingungen für kontinuierliche LPs}
\begin{itemize}
	\item LP in Normalform
		\begin{equation*}\label{nf}
			\min_{x} c^Tx \text{ subject to } Ax = b, x\geq 0\tag{P}
		\end{equation*}
	\item zulässige Menge: Polyeder
		\begin{equation*}
			P = \set{ x | Ax = b ,x \geq 0 }
		\end{equation*}
	\item Problem konvex $\to$	lokale Minima = globale Minima	
	\item duales Problem
		\begin{equation*}\label{dual_cont}
			\max_{y}b^Ty \text{ subject to } A^Ty \leq c, y \in \R^n \tag{D}
		\end{equation*}
	\item schwache Dualität\\
		$\forall x$ zulässig für \eqref{nf}\\% todo mach das ordentlich
		$\forall y$ zulässig für \eqref{dual_cont}:% todo mach das ordentlich
		\begin{equation*}
			c^Tx \geq b^Ty
		\end{equation*}
		bei Gleichheit: $x$ löst \eqref{nf}, $y$ löst \eqref{dual_cont}
	\item Starke Dualität\\
		Es sind äquivalent
		\begin{enumerate}
			\item \eqref{nf} hat eine Lösung $x^*$
			\item \eqref{dual_cont} hat eine Lösung $y^*$
			\item mk
		\end{enumerate}
	\item KKT-Bedingungen für LPs
		\begin{itemize}
			\item $x^*$ löst \eqref{primal_cont}
			\item $y^*$ löst \eqref{dual_cont}
			\item $(x^*,y^*)$ lösen das KKT-System
				\begin{align*}
					Ax^* &= b , \ x^* \geq 0 \quad \text{(primale Zulässigkeit)}\\
					A^{T} y^* &\leq c\quad \text{(duale Zulässigkeit)}\\
					\forall i = 1,\dots , n: x_{i}&= 0 \text{ oder } \left(A^{T}y^*  \right)_{i} = c_{i} \text{ (Komplementaritätsbedingungen)}
				\end{align*}
				\begin{equation*}
					b^{T}\underbrace{y^* = (\underbrace{x^*}_{\geq 0})^{T}}_{\text{primal Zul.}} \underbrace{\underbrace{A^{T} y^*}_{\leq c }}_{\text{dual Z.}} \stackrel{\text{Kompbed.}}= \left(x^*\right)^{T} c
				\end{equation*}
		\end{itemize}
		
	\item Ecken und Lösungen\\
		$ \hat{x}$ Ecke von $P \iff$  $ \hat{x}$ kann nicht als echte Konvexkombination von Punkten aus $P$ geschrieben werden
		$\iff$ Sei
		\begin{equation*}
			I = \{i = 1 ,\dots, n | \hat{x}_{i} \geq 0 \} = \supp(\hat{x})
		\end{equation*}
		Dann gilt $\rang(A_{\cdot,I})=|I|$
	\item Hat das LP \eqref{nf} eine Lösung, so gibt es auch eine Ecklösung.
	\item Es gibt nur endlich viele Ecken
	\item Idee des Simplex-Verfahrens: Ecken von $P$ in sinnvolle Reihenfolge absuchen.\\
		\underline{Annahme:} $A \in \R^{m \times n }$ hat \underline{vollen Zeilenrang} m. \\
		Sei $\hat{x}$ eine Ecke von $P$ und $I = \{i | \hat{x}_{i}>0\}$ \\
		$\implies$ rang($A_{\cdot,I}   )= |I| \leq m$ \\
		$\implies$ Es gibt $B \subset \{1,\dots,n\}$ mit $I \subset B, |B| = m $ und $A_{B}= A_{\cdot,B}$ ist regulär
	\item Basen\\
		Sei $B \subset \{1,\dots,n\}$ mit $|B|=m$ und $N = \{1,\dots,n\}\setminus B$\\
		$\to B$ heißt \underline{Basis}, falls $A_{B}$ regulär\\
		$\to$ $B$ heißt \underline{primal zulässige Basis}, falls
		\begin{equation*}
			x_{B}=A_{B}^{-1}b \geq 0
		\end{equation*} $\implies$ Mit $x_{N} = 0$ ist $(x_{B},x_{N})$ zulässig für \eqref{nf} und eine Ecke von $P$ \\
		$\to$ B heißt \underline{dual zulässige Basis}, falls
		\begin{equation*}
			A_{N}^TA_{B}^{-T}c_{b} \leq c_{N} \implies y \text{ ist zulässig für \eqref{dual_cont}}
		\end{equation*}
		$\implies$ $\left(x_{B},x_{N} \right)$ mit $x_{B} = A^{-1}_{B},\ x_{N}= 0$ heißt \underline{Basislösung}. Ist $x_{B} > 0 $ so heißt die Basislösung \underline{nichtdegeneriert}.
\end{itemize}

\subsection{Wiederholung Simplex-Verfahren}
Annahme: $A \in R^{m \times n}$ hat Rang $m$.\\
Sei $B$ eine primal zulässige Basis mit Basislösung
\begin{align*}
	\hat{x}_{N}&=0,\\
	\hat{x}_{B}&= A_{B}^{-1}b
\end{align*}
Für alle $x \in P$ gilt:
\begin{align*}
	Ax&=
	\begin{pmatrix}
		A_{B} & A_{N}
	\end{pmatrix}
	\begin{pmatrix}
		x_{B} \\ x_{N}
	\end{pmatrix}
	\\
	  & A_{B}x_{B} + A_{N}x_{N}= b
\end{align*}
$\implies x_{B} = A_{B}^{-1}b - A_{B}^{-1}A_{N}x_{N} \to$ Zielfunktion vereinfachen
\begin{align*}
	c^Tx&= c_{B}^Tx_{B} + c_{N}^Tx_{N} = c_{B}^T \underbrace{A_{B}^{-1}b}_{= \hat{x}_{B}} - c_{B}^TA_{B}^{-1}A_{N}x_{N} + c_{N}^Tx_{N}\\
		&= c^{T}_{B} \hat{x}_{B} +( \underbrace{ c_{N} - A_{N}^{T} \underbrace{A_{B}^{-T}c_{B}}_{=y} }_{=: z_{N}, \text{ reduzierte Kosten}} )^{T} x_{N}
\end{align*}

\begin{itemize}
	\item gilt $z_{N} \geq 0$: $\hat{x}$ löst LP ( mit dualer Variable y)
	\item Andernfalls: Wähle $j\in \N$ mit $z_{j}<0$ \\
		Frage: Wie groß kann $x_{j}$ gewählt werden, ohne $P$ zu verlassen?\\
		neues $x_{N}= \gamma e_{j}$ \\
		$\implies$ neues $x_{B} = \hat{x}_{B}-A_{B}^{-1}A_{N}\gamma e_{j}= \hat{x}_{B}-A_{B}^{-1}A_{N}\gamma A_{B}^{-1}A_{\cdot,I} \overset{!}{\geq} 0$
		\begin{itemize}
			\item Wähle $\gamma = \min \{ \frac{\hat{x}_{i}}{w_{i}}|w_{i} > 0 \}$
			\item Andernfalls wähle $i \in B$ mit $\gamma = \frac{\hat{x}_{i}}{w_{i}}$
		\end{itemize}
	\item neue Ecke
		\begin{align*}
			\hat{x}_{B}-\gamma_{w}&= x_{B}^+\\
			x_{j}^+& = \gamma\\
			x_{k}^+ &= 0 \quad \forall \text{ vorherigen } k\\
			B^+ &= (B \ \{i\})\cup \{j\}\\
			N^+ &= (N \ \{j\})\cup \{i\}\\
			B& = \{1,3,5\} \\
			B& = (3,1,5)
		\end{align*}
\end{itemize}
gesucht: primal zulässige Basis für
\begin{equation*}
	\min_{x} c^Tx \text{ subject to } Ax = b , x \geq 0
\end{equation*}
Simplex-Phase 1: Löse das Hilfsproblem
\begin{align*}
	\min_{x,s} \sum_{i=1}^{m} s_{i} \text{ subject to }
	\begin{pmatrix}
		A& I
	\end{pmatrix}
	\begin{pmatrix}
		x \\ s
	\end{pmatrix}
	\quad,(x,s)& \geq 0
\end{align*}
Gilt in einer Lösung ($x^0$), dass $s^* =0$, so ist das $x^*$ zulässig für \eqref{nf} und die Basis des Hilfsproblems \glqq ist\grqq\ eine primal zulässige Basis für \eqref{primal_cont}.
Primal zulässige Startbasis für Hilfsproblem
\begin{equation*}
	x = 0, s = b \geq 0, \text{ Basismatrix } I
\end{equation*}
Tableau-Methode für
\begin{equation*}
	\min_{x}c^Tx \text{ subject to } Ax \leq b , x \geq 0
\end{equation*}
\section{Duales Simplex-Verfahren}
primales LP
\begin{equation*}\label{primalLP}
	\min_{x}c^{T} x \text{ subject to }Ax = b, x \geq 0 \tag{P}
\end{equation*}
duales LP
\begin{equation*}\label{dualLP}
	\max_{y}b^{T} y \text{ subject to }A^{T} y \leq c, y \geq 0 \tag{D}
\end{equation*}
Annahme $A \in \R^{m \times n}$ hat Rang $m$ \\
$B$ Basis $\implies x_{B}= A^{-1}_{B}b, x_{N}=0$\nl
\underline{Idee:} Wende Simplex-Verfahren auf (D) an.\\
$\to$ duale Normalform:
\begin{equation*}\label{dualnf}
	\max_{y} b^{T} y \text{ subject to }
	\begin{pmatrix}
		A^{T} & I
	\end{pmatrix}
	\begin{pmatrix}
	y\\z	
	\end{pmatrix}
	= c, \quad z \geq 0, \quad y \in \R^m \tag{D'}
\end{equation*}
Basis von (D'):$
\begin{pmatrix}
	\underbrace{A^{T}}_{m} \underbrace{I}_{n}
\end{pmatrix}
\in R^{n \times(m +n)}$
Basis $H \subset \set{1,\dots ,n+m }$ mit $|H|=n$ und $D_{\cdot,H}\in \R^{n \times n}$ regulär
\begin{theorem}
	Entweder (D') ist unzulässig oder unbeschränkt oder es gibt eine optimale Basislösung $(y^*,z^*)$ so dass die zugehörige basis von der Form ist:
	\begin{equation*}
		H_{\text{opt}}=\underbrace{ \set{1,..,m }}_{\text{ganzes $A$ in Basismatrix}}\cup (N+m)
	\end{equation*}
	mit $N \subset \set{1,\dots ,n }, |N|= n-m$ ($N$ zeigt an, welche Spalten von $I$ gebraucht werden)
	$\implies$ Basen für (D') werden i.A. durch $N$ beschrieben, nicht durch $H$.
\end{theorem}
Welche Basis $H$ bzw. $N$ liefert zulässige Basislösung für (D')?
% irgendwas kompiliert hier nicht
\begin{align*}
	\begin{pmatrix}
		A^{T}  & I
	\end{pmatrix}
	\begin{pmatrix}
	y\\z	
	\end{pmatrix}
	&=c, \quad z \geq 0\\
	&{}\iff A_{B}^{T} y + z_{B} \geq c_{B}, \quad z_{B} \geq 0\\
	&{}\hspace{1.1cm} A_{N}^{T} y + z_{N} = c_{N}, \quad z_{N} \geq 0 \\
	&{}\iff y = A_{B}^{-T}(c_{B}-z_{B})\\
	&{}\hspace{1.1cm} z_{N}= c_{N} - A_{N}^{T}y = c_{N}-A_{N}^{T} A_{B}^{-T}(c_{B}-z_{B}) ,\quad z_{B}\geq 0 ,z_{N} \geq 0
\end{align*}
$(y,z_{B},z_{N})$ Basislösung $\to$ Nichtbasisvariablen $z_{B} =0$ \\
$\implies$
\begin{equation*}
	y = A_{B}^{-T}c_{B}, \quad z_{N}= c_{N}- A_{N}^{T} \underbrace{A_{B}^{-T}c_{B}}_{{=y}}\geq 0
\end{equation*}
\subsection{Duales Simplex-Verfahren}
Initialisierung: Dual zulässige Basis $B$, d.h. $B \subset \set{1,\dots ,n }$ mit $|B|=m$, $A_{B}$ regulär und $z_{B}=0,y=A_{B}^{-T}c_{B}, z_{N}= c_{N}-A_{N}^{T}y \geq 0$
\begin{enumerate}%[label = Schritt \arabic)]
	\item Bestimme zugehörige komplementäre duale Variable
		\begin{align*}
			x_{N}&=0 \quad (\to \text{komplementär }z_{N})\\
			x_{B}&= A_{B}^{-1} b\quad ( \to A(x_{B},x_{N})^{T} =b)
		\end{align*}
	\item Gilt $x_{B} \geq 0 $: \textbf{Stop}.\\
		$(y,z_{B},z_{N}),(x_{B},x_{N})$ KKT-Punkt $\implies$ Lösung gefunden.\\
		Andernfalls wähle $ i \in B$ mit $x_{i}<0$ ($\to z_{i}>0$ verkleinert dualen Zielfunktionswert)
	\item Löse $A_{B}^{T} w = e_{i}$, $\alpha_{N} = -A_{N}^{T} w$
	\item Schrittweitenbestimmung:\\
		Gilt $\alpha_{N} \leq 0 $ :\textbf{Stop}, (D') ist unbeschränkt ($\to$ (P) unzulässig).\\
		Andernfalls berechne $\gamma = \min \set{ \frac{z_{i}}{\alpha_{i}}|j \in N , \alpha_{j} >0 }$ und wähle $j \in N$ mit $\gamma = \frac{z_{j}}{\alpha_{j}}$
	\item Update:
		\begin{align*}
			z_{N}^+ &= z_{N} - \gamma \alpha_{N} \quad (\to z_{N} \geq 0, z_{j}^+ =0)\\
			z_{i}^+ &= \gamma\\
			y^+ &= y -\gamma w\\
			N^+ &= (N \backslash \set{ j }) \cup \left\{ i \right\}\\
			B^+ &= (B \backslash \set{ i }) \cup \left\{ j \right\}
		\end{align*}
\end{enumerate}

\subsection{(primales) Simplex-Verfahren für LPs mit Schranken}
Betrachte
\begin{equation*}
	\min_{x} c^{T} x \text{ subject to } Ax = b ,\quad l \leq x \leq u
\end{equation*}
mit $l \in \left(\R \cup \set{ - \infty } \right)^n,u \in \left(\R \cup \left\{ +\infty \right\} \right)^n $

\underline{Ziel:} möglichst nahe an der Form
\begin{equation*}
	\min_{x} c^{T} x \text{ subject to } Ax = b ,\quad x \geq 0
\end{equation*}
kommen.\\
\underline{mögliche Modifikationen:}
\begin{itemize}
	\item Schlupfvariablen + Variablensplit $x = x^+ -x^-, x^+,x^- \geq0 $ (Nachteil: erhöht die Anzahl der Variablen und linearen Gleichungen)
	\item Fall: $x_{i} \geq l_{i}$ mit $l_{i}\in \R$ : Substituiere $\hat{x}_{i} := x_{i}- l_{i}\geq 0$
	\item Fall: $x_{i} \leq u_{i}$ mit $u_{i}\in \R$ : Substituiere  $\hat{x}_{i} := u_{i}- x_{i}\geq 0$
	\item Fall: $l_{i} \leq x_{i} \leq u_{i}$ mit $l_{i},u_{i} \in \R$ : Substituiere $0 \leq \hat{x}_{i} := x_{i}- l_{i} \leq u_{i}-l_{i}$
	\item Fall $-\infty \leq x_{i} \leq \infty$ : Freie Variable: entweder Variablensplit $x_{i}= x_{i}^+ - x_{i}^-$ oder: $x_{i}$ als freie Variable im Simplex-Verfahren berücksichtigen( wie $y$ im dualen Simplex)
\end{itemize}
Angenommen, es gibt keine freien Variablen $\implies$ oBdA LP der Form
\begin{equation*}
	\min_{x} c^{T} x \text{ subject to } Ax = b, \quad 0 \leq x \leq u
\end{equation*}
mit $u \in [0, + \infty]^n$.\nl
Bisher im primalen Simplex-Verfahren:\\
Basis $B$, Basisvariablen $x_{B}= A_{B}^{-1} b \geq 0$, Nichtbasisvariablen $x_{N}=0$ \\
\underline{Idee:} Teile die Nichtbasisvariablen in
\begin{align*}
	N_{l} &= \set{ i \in N \ | \ x_{i} = 0  } \implies x_{N_{l}}=0\\
	N_{u} &= \set{ i \in N \ | \ x_{i} = u_{i}  } \implies x_{N_{u}}=u_{N_{u}}
\end{align*}
Wie im Simplex-Verfahren:
\begin{align*}
	A_{B}x_{B} + A_{N_{l}}x_{N_{l}} + A_{N_{u}} x_{N_{u}} = b \implies x_{B} = A_{B}^{-1} (b - A_{N_{l}} x_{N_{l}} - A_{N_{l}}x_{N_{l}})\\
	c^{T} x = c_{B}^{T} x_{B} + c_{N_{l}}^{T} x_{N_{l}}+c_{N_{u}}^{T} x_{N_{u}} = c_{B}^{T} A_{B}^{-1} b + z_{N_{l}}^{T} x_{N_{l}} + z_{N_{u}}^{T} x_{N_{u}}
\end{align*}
Identifiziere $i \in N_{l}$ mit $z_{i} <0 $ oder $ i\in N_{u}$ mit $z_{i}> 0$.\\
Bei Schrittweiten beachten: $x_{B} = \gamma w \in [0,u_{B}]$ und
\begin{equation*}
	x_{i}^+ = \begin{cases}
	 \gamma \in [0,u_{i}]\\
	 u_{i}-\gamma
\end{cases}
\end{equation*}
Basisupdate: neuer Fall $B^+ = B$, $i$ wechselt von $N_{l}$ nach $N_{u}$ oder umgekehrt.

